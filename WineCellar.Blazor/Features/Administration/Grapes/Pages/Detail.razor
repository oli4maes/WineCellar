@page "/Administration/Grapes/{id:int}"
@using Microsoft.AspNetCore.Components.Forms

<PageTitle>Kave - Administration - Grapes</PageTitle>

<AuthorizeView Policy="AdminRole">
    <Authorized>
        <MudCard>
            <EditForm Model="@_grape" OnValidSubmit="HandleValidSubmit" Context="editContext">
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.h4">@_grape.Name</MudText>
                    </CardHeaderContent>
                    <CardHeaderActions>
                        @if (!_editMode)
                        {
                            <MudFab StartIcon="@Icons.Material.Filled.Edit" Color="Color.Primary" @onclick="SetEditMode" Size="Size.Small"></MudFab>
                        }
                    </CardHeaderActions>
                </MudCardHeader>
                <MudCardContent>
                    <!-- Name -->
                    <MudTextField @bind-Value="_grape.Name" Label="Name" Disabled="!_editMode" For="@(() => _grape.Name)" Class="mt-3"/>

                    <!-- Description -->
                    <MudTextField @bind-Value="_grape.Description" Label="Description" Disabled="!_editMode" Class="mt-3"/>

                    <!-- Grape Type -->
                    <MudSelect T="GrapeType"
                               @bind-Value="_grape.GrapeType"
                               Placeholder="Select grape type"
                               Label="Type"
                               Disabled="!_editMode"
                               For="@(() => _grape.GrapeType)"
                               Class="pt-5">
                        @foreach (var item in Enum.GetValues(typeof(GrapeType)))
                        {
                            <MudSelectItem T="GrapeType" Value="(GrapeType)item">@item</MudSelectItem>
                        }
                    </MudSelect>
                </MudCardContent>
                <MudCardActions>
                    <MudButton ButtonType="ButtonType.Button"
                               Variant="Variant.Outlined"
                               Color="Color.Error"
                               OnClick="Back">
                        Back
                    </MudButton>
                    @if (_editMode)
                    {
                        <MudButton Class="ml-4"
                                   ButtonType="ButtonType.Submit"
                                   Variant="Variant.Outlined"
                                   StartIcon="@Icons.Material.Filled.Save"
                                   Color="Color.Primary">
                            Save
                        </MudButton>
                    }
                </MudCardActions>
            </EditForm>
        </MudCard>
    </Authorized>
</AuthorizeView>